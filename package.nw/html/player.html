<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.bootcdn.net/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
  <script src="https://cdn.bootcdn.net/ajax/libs/vue/2.6.12/vue.min.js"></script>
  <title>henhao-player</title>
  <style>
    body {
      margin: 0;
    }

    video,
    img {
      position: absolute;
      left: 0;
      width: 100%;
      top: 0;
      height: 100%;
      display: block;
      object-fit: cover;
      /*-webkit-app-region: drag;*/
    }
  </style>
</head>

<body>
  <div id="app"></div>
  <template id="tpl">
    <div>
      <img :src="backgroundImage" class="animate__animated animate__fadeIn" v-if="type === 'image'" />
      <video :muted="muted" loop autoplay v-if="type === 'video'" class="animate__animated animate__fadeIn" :src="src"></video>
    </div>
  </template>

  <script>
    let vm = (() => {
      let template = document.getElementById("tpl").innerHTML;
      return new Vue({
        template,
        data() {
          return {
            muted: true,
            src: "",
            type: "video",
            backgroundImage: "",
            backgroundSize: 'cover'
          }
        },
        computed: {
          video() {
            return document.getElementById('video')
          }
        },
        created() {
          window.addEventListener('message', e => {
            console.log(e);
            let type = e.data.type.toLocaleLowerCase();
            let command = e.data.command.toLocaleLowerCase();
            this.type = type;
            switch (type) {
              case "video":
                switch (command) {
                  // 设置播放源
                  case 'src':
                    this.src = e.data.message;
                    this.backgroundImage = ''
                    break;
                  // 设置静音状态
                  case 'muted':
                    this.muted = e.data.message;
                    break;
                }
                break;
              case "image":
                switch (command) {
                  // 设置背景
                  case 'src':
                    this.backgroundImage = e.data.message;
                    this.src = '';
                    break;
                  // 设置背景方式
                  case 'size':
                    this.backgroundSize = e.data.message
                    break;
                }
                break;
            }
          });
        },
        methods: {
        }
      }).$mount('#app');
    })();
    // let video = document.getElementById('video');
    // window.addEventListener('message', e => {
    //   console.log(e);
    //   switch (e.data.type.toLocaleLowerCase()) {
    //     // 设置播放源
    //     case 'set-src':
    //       video.src = e.data.message;
    //       video.play();
    //       break;
    //     // 设置静音状态
    //     case 'set-muted':
    //       video.muted = e.data.message;
    //       break;
    //   }
    // });
  </script>
</body>

</html>